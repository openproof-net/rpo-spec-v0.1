<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenProof.net — RPO v0.1 Sandbox</title>
  <meta name="description" content="RPO v0.1 Sandbox — from a short narrative to a deterministic draft RPO bundle (rpo.json + sha256). No AI. No storage." />
  <meta name="robots" content="index, follow" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Orbitron:wght@500;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-deep:#04040e;
      --bg-mid:#0b0f14;

      --gold-soft:#f1e6a3;
      --gold:#d4af37;
      --gold-deep:#8f7633;

      --ivory:#f7f3e8;
      --ink-soft:#b3a48b;
      --ink:#d8cfba;

      --panel:#fbf8f1;
      --panel2:#f7f3e8;
      --panel-ink:#1f1c16;
      --panel-ink2:#3a352a;

      --radius:24px;
      --radius2:18px;
      --shadow-soft:0 26px 70px rgba(0,0,0,0.55);
      --shadow-panel:0 22px 60px rgba(0,0,0,0.45);

      --cta1:#ffdfb0;
      --cta2:#f48b45;

      --line:rgba(212,175,55,0.22);
      --line-strong:rgba(212,175,55,0.45);

      --ok:#46ff99;
      --warn:#ffb35a;
      --muted:#b8ad98;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
      color:var(--ivory);
      background:
        radial-gradient(circle at 10% -10%, rgba(241,230,163,0.25), transparent 55%),
        radial-gradient(circle at 90% 110%, rgba(241,230,163,0.18), transparent 55%),
        linear-gradient(180deg, #050712, #020208 60%, #050712 100%);
      overflow-x:hidden;
    }

    /* background field */
    #bg-field{
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:-1;
      background:
        radial-gradient(circle at top, rgba(241,230,163,0.12), transparent 60%),
        radial-gradient(circle at bottom, rgba(241,230,163,0.06), transparent 65%),
        radial-gradient(circle at center, #04040e, #020208 70%);
    }

    /* top bar */
    header.top-bar{
      position:fixed; top:0; left:0; right:0;
      height:68px;
      padding:0 38px;
      display:flex; align-items:center; justify-content:space-between;
      z-index:20;
      background: linear-gradient(to bottom, rgba(4,4,14,0.96), rgba(4,4,14,0.88), transparent);
      backdrop-filter: blur(18px);
      border-bottom:1px solid var(--line);
    }
    .top-left{display:flex; align-items:center; gap:14px; min-width:260px}
    .emblem-wrap{
      width:38px;height:38px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      background: radial-gradient(circle at 30% 0, var(--gold-soft), var(--gold) 60%, var(--gold-deep) 100%);
      box-shadow:0 0 22px rgba(241,230,163,0.80);
      overflow:hidden;
      flex:0 0 auto;
    }
    .emblem-wrap img{
      width:30px;height:30px; object-fit:contain; display:block;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,0.35));
    }
    .brand-title{
      font-family:Orbitron, sans-serif;
      letter-spacing:0.18em;
      text-transform:uppercase;
      font-size:0.74rem;
      color:rgba(243,237,215,0.78);
      white-space:nowrap;
    }
    .brand-title span{color:var(--gold-soft)}

    .nav-chips{
      display:flex; gap:10px; align-items:center;
      flex-wrap:wrap;
    }
    .chip{
      font-family:Orbitron, sans-serif;
      font-size:0.72rem;
      letter-spacing:0.12em;
      text-transform:uppercase;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(241,230,163,0.28);
      background:rgba(7,8,20,0.55);
      backdrop-filter: blur(10px);
      color:rgba(243,237,215,0.80);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .chip:hover{border-color:rgba(241,230,163,0.55); color:var(--gold-soft)}
    .chip.current{
      border-color:rgba(212,175,55,0.70);
      color:var(--gold-soft);
      background:rgba(7,8,20,0.72);
    }

    .top-cta{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 18px;
      border-radius:999px;
      border:1px solid rgba(244,186,120,0.92);
      font-size:0.78rem;
      text-transform:uppercase;
      letter-spacing:0.12em;
      background: radial-gradient(circle at 20% 0, var(--cta1), var(--cta2));
      color:#2a1204;
      text-decoration:none;
      box-shadow:0 12px 26px rgba(0,0,0,0.65);
      white-space:nowrap;
    }
    .top-cta:active{transform:translateY(1px)}

    /* layout */
    main{
      padding:96px 38px 80px;
      min-height:100vh;
    }
    .container{
      width:min(1240px, 92vw);
      margin:0 auto;
    }

    .hero{
      display:grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.1fr);
      gap:34px;
      align-items:start;
      margin-top:18px;
    }

    .badges{
      display:flex; flex-wrap:wrap; gap:10px;
      margin-bottom:14px;
    }
    .badge{
      font-family:Orbitron,sans-serif;
      font-size:0.70rem;
      letter-spacing:0.12em;
      text-transform:uppercase;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(241,230,163,0.28);
      background:rgba(7,8,20,0.55);
      color:rgba(243,237,215,0.80);
    }

    h1{
      font-family:Orbitron,sans-serif;
      text-transform:uppercase;
      letter-spacing:0.07em;
      line-height:1.06;
      font-size: clamp(2.0rem, 4.6vw, 3.25rem);
      margin-bottom:12px;
      color:var(--ivory);
    }
    h1 .gold1{color:var(--gold-soft)}
    h1 .gold2{color:var(--gold)}
    .lead{
      color:rgba(243,237,215,0.78);
      line-height:1.7;
      font-size:1.02rem;
      max-width:62ch;
    }
    .lead .hl{color:var(--gold-soft)}
    .note{
      margin-top:12px;
      color:rgba(243,237,215,0.72);
      font-size:0.92rem;
    }
    .note strong{color:var(--gold-soft); font-weight:600}

    .purpose{
      position:relative;
      background:
        radial-gradient(circle at 0 0, rgba(241,230,163,0.12), transparent 60%),
        linear-gradient(145deg, rgba(10,12,27,0.97), rgba(5,7,18,0.98));
      border-radius:26px;
      border:1px solid rgba(212,175,55,0.50);
      box-shadow:var(--shadow-soft);
      padding:22px 22px 18px;
      overflow:hidden;
    }
    .purpose::before{
      content:"";
      position:absolute; inset:-1px;
      border-radius:inherit;
      border:1px solid rgba(241,230,163,0.18);
      pointer-events:none;
    }
    .purpose h3{
      font-family:Orbitron,sans-serif;
      font-size:0.86rem;
      letter-spacing:0.18em;
      text-transform:uppercase;
      color:rgba(243,237,215,0.78);
      margin-bottom:10px;
    }
    .purpose ul{padding-left:18px}
    .purpose li{
      color:rgba(243,237,215,0.80);
      line-height:1.55;
      margin:7px 0;
    }
    .purpose b{color:var(--gold-soft); font-weight:600}
    .purpose .tag{
      position:absolute;
      top:14px; right:14px;
      font-family:Orbitron,sans-serif;
      font-size:0.70rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(241,230,163,0.35);
      background:rgba(7,8,20,0.72);
      color:var(--gold-soft);
      user-select:none;
    }

    /* sandbox section */
    .sandbox{
      margin-top:34px;
      display:grid;
      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
      gap:22px;
      align-items:start;
      scroll-margin-top:92px;
    }

    .card{
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      border-radius:26px;
      border:1px solid rgba(212,175,55,0.28);
      box-shadow:var(--shadow-panel);
      padding:18px 18px 16px;
      color:var(--panel-ink);
    }
    .card h2{
      font-family:Orbitron,sans-serif;
      font-size:0.95rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:var(--panel-ink);
      margin-bottom:8px;
    }
    .card .sub{
      color:rgba(31,28,22,0.72);
      font-size:0.92rem;
      line-height:1.55;
      margin-bottom:12px;
    }

    label{
      display:block;
      font-family:Orbitron,sans-serif;
      font-size:0.70rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:rgba(31,28,22,0.62);
      margin:12px 0 6px;
    }
    input, select, textarea{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(212,175,55,0.22);
      background:rgba(255,255,255,0.78);
      padding:10px 12px;
      font-size:0.96rem;
      color:var(--panel-ink);
      outline:none;
    }
    textarea{
      min-height:148px;
      resize:vertical;
      line-height:1.55;
      font-family:Inter, system-ui, sans-serif;
    }
    input:focus, select:focus, textarea:focus{
      border-color:rgba(212,175,55,0.55);
      box-shadow:0 0 0 4px rgba(212,175,55,0.12);
    }

    .btn-row{
      display:flex; flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
      align-items:center;
    }

    .btn{
      border:1px solid rgba(212,175,55,0.45);
      border-radius:999px;
      padding:10px 14px;
      font-family:Orbitron,sans-serif;
      font-size:0.78rem;
      letter-spacing:0.12em;
      text-transform:uppercase;
      cursor:pointer;
      background:rgba(7,8,20,0.08);
      color:rgba(31,28,22,0.84);
      user-select:none;
    }
    .btn:hover{border-color:rgba(212,175,55,0.75)}
    .btn.primary{
      border:1px solid rgba(244,186,120,0.92);
      background: radial-gradient(circle at 20% 0, var(--cta1), var(--cta2));
      color:#2a1204;
      box-shadow:0 12px 24px rgba(0,0,0,0.22);
    }
    .btn.ghost{
      background:rgba(255,255,255,0.55);
      color:rgba(31,28,22,0.84);
    }

    .fineprint{
      margin-top:10px;
      color:rgba(31,28,22,0.60);
      font-size:0.86rem;
      line-height:1.45;
    }
    .fineprint .k{font-family:Orbitron,sans-serif; letter-spacing:0.12em; text-transform:uppercase; font-size:0.74rem; color:rgba(31,28,22,0.72)}

    /* right outputs */
    .metrics-grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:10px;
      margin-top:10px;
    }
    .mini{
      border:1px solid rgba(212,175,55,0.22);
      border-radius:16px;
      background:rgba(255,255,255,0.72);
      padding:10px 10px;
    }
    .mini .t{
      font-family:Orbitron,sans-serif;
      font-size:0.66rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:rgba(31,28,22,0.62);
      margin-bottom:6px;
    }
    .mini .v{
      font-family:Orbitron,sans-serif;
      font-size:1.05rem;
      color:rgba(31,28,22,0.92);
    }

    .hashbox{
      margin-top:10px;
      border:1px dashed rgba(212,175,55,0.45);
      border-radius:16px;
      padding:10px 10px;
      background:rgba(255,255,255,0.62);
    }
    .hashbox .t{
      font-family:Orbitron,sans-serif;
      font-size:0.66rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:rgba(31,28,22,0.62);
      margin-bottom:6px;
    }
    .hashbox .hash{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      font-size:0.84rem;
      color:rgba(31,28,22,0.82);
      word-break:break-all;
    }

    .section-title{
      margin-top:14px;
      padding-top:12px;
      border-top:1px solid rgba(212,175,55,0.28);
      font-family:Orbitron,sans-serif;
      font-size:0.82rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:rgba(31,28,22,0.86);
    }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      margin-top:10px;
      overflow:hidden;
      border-radius:16px;
      border:1px solid rgba(212,175,55,0.18);
      background:rgba(255,255,255,0.70);
    }
    th, td{
      padding:10px 10px;
      font-size:0.92rem;
      color:rgba(31,28,22,0.86);
      border-bottom:1px solid rgba(212,175,55,0.12);
      vertical-align:top;
    }
    th{
      font-family:Orbitron,sans-serif;
      font-size:0.68rem;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:rgba(31,28,22,0.62);
      background:rgba(255,255,255,0.55);
    }
    tr:last-child td{border-bottom:none}

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(212,175,55,0.22);
      font-family:Orbitron,sans-serif;
      font-size:0.70rem;
      letter-spacing:0.10em;
      text-transform:uppercase;
      background:rgba(255,255,255,0.62);
      color:rgba(31,28,22,0.78);
      white-space:nowrap;
    }
    .pill.ok{border-color:rgba(70,255,153,0.55); color:rgba(31,28,22,0.85)}
    .pill.warn{border-color:rgba(255,179,90,0.65); color:rgba(31,28,22,0.85)}

    .highlights{
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(212,175,55,0.18);
      background:rgba(255,255,255,0.70);
      padding:12px 12px;
      color:rgba(31,28,22,0.86);
    }
    .highlights .sub{
      margin:0 0 10px;
      color:rgba(31,28,22,0.68);
      font-size:0.90rem;
      line-height:1.55;
    }
    .hl-item{
      margin:8px 0;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(212,175,55,0.18);
      background:rgba(255,255,255,0.58);
      font-size:0.95rem;
      line-height:1.5;
    }
    mark{
      background:rgba(255,179,90,0.35);
      color:rgba(31,28,22,0.92);
      padding:0 3px;
      border-radius:6px;
    }

    .json-head{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .json-actions{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .code{
      margin-top:8px;
      border-radius:16px;
      border:1px solid rgba(212,175,55,0.22);
      background:rgba(7,8,20,0.92);
      color:rgba(247,243,232,0.90);
      padding:12px 12px;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      font-size:0.86rem;
      line-height:1.55;
      max-height:280px;
      overflow:auto;
      white-space:pre;
    }

    /* footer CTA */
    .footer-cta{
      margin-top:22px;
      border-radius:26px;
      border:1px solid rgba(212,175,55,0.28);
      background: linear-gradient(145deg, rgba(10,12,27,0.92), rgba(5,7,18,0.95));
      box-shadow:var(--shadow-soft);
      padding:18px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .footer-cta p{
      color:rgba(243,237,215,0.84);
      line-height:1.55;
      max-width:78ch;
      margin:0;
    }
    .footer-cta p .hl{color:var(--gold-soft)}
    .footer-cta a{
      display:inline-flex; align-items:center; justify-content:center;
      padding:12px 18px;
      border-radius:999px;
      border:1px solid rgba(244,186,120,0.92);
      text-transform:uppercase;
      letter-spacing:0.14em;
      font-size:0.78rem;
      background: radial-gradient(circle at 20% 0, var(--cta1), var(--cta2));
      color:#2a1204;
      text-decoration:none;
      box-shadow:0 18px 34px rgba(0,0,0,0.55);
      white-space:nowrap;
    }

    .bottom-note{
      margin-top:12px;
      color:rgba(243,237,215,0.62);
      font-size:0.92rem;
      line-height:1.55;
    }

    /* responsive */
    @media (max-width: 980px){
      header.top-bar{padding:0 16px}
      .nav-chips{display:none}
      main{padding:92px 16px 72px}
      .hero{grid-template-columns:1fr; gap:18px}
      .sandbox{grid-template-columns:1fr; gap:16px}
      .metrics-grid{grid-template-columns: repeat(2, minmax(0, 1fr))}
    }
    @media (max-width: 520px){
      .metrics-grid{grid-template-columns:1fr}
      .top-left{min-width:auto}
      .brand-title{display:none}
    }
  </style>
</head>

<body>
  <canvas id="bg-field"></canvas>

  <header class="top-bar">
    <div class="top-left">
      <div class="emblem-wrap">
        <img
          src="https://uploads.strikinglycdn.com/files/5b108f2f-0feb-4789-a4dd-d1d21cd5eec6/Capture%20d%E2%80%99e%CC%81cran%202025-11-01%20a%CC%80%2016.30.35.png"
          alt="OpenProof logo"
        />
      </div>
      <div class="brand-title">OPENPROOF<span>.NET — RPO v0.1</span></div>
    </div>

    <nav class="nav-chips" aria-label="Primary navigation">
      <span class="chip current">Sandbox</span>
      <a class="chip" href="https://rpo.openproof.net/how-it-works.html" target="_blank" rel="noopener noreferrer">How it works</a>
      <a class="chip" href="https://rpo.openproof.net/tests.html" target="_blank" rel="noopener noreferrer">Tests</a>
      <a class="chip" href="https://rpo.openproof.net/examples.html" target="_blank" rel="noopener noreferrer">Examples</a>
    </nav>

    <!-- real CTA: scroll to the sandbox section (not fake) -->
    <a class="top-cta" href="#sandbox">TRY THE LIVE DEMO</a>
  </header>

  <main>
    <div class="container">
      <section class="hero">
        <div>
          <div class="badges">
            <span class="badge">EXPERIMENTAL</span>
            <span class="badge">DETERMINISTIC</span>
            <span class="badge">NO AI MODEL</span>
            <span class="badge">RPO-COMPATIBLE</span>
          </div>

          <h1>
            SANDBOX — <span class="gold1">FROM A SHORT STORY</span><br/>
            TO A <span class="gold2">DRAFT RPO BUNDLE</span>
          </h1>

          <p class="lead">
            Paste a short narrative (1–3 paragraphs). This sandbox extracts a minimal, deterministic structure:
            <span class="hl">signals</span>, <span class="hl">axes</span>, <span class="hl">thresholds</span>,
            and generates a draft <span class="hl">rpo.json</span> plus a public <span class="hl">sha256</span> proof hash.
          </p>

          <p class="note">
            <strong>Important:</strong> the hash proves integrity, not truth. This demo is a format illustration, not legal advice.
          </p>
        </div>

        <aside class="purpose">
          <div class="tag">DEMO MODE</div>
          <h3>WHAT THIS PAGE IS DESIGNED TO TRIGGER</h3>
          <ul>
            <li><b>Relief:</b> “I’m not crazy. My story has a structure.”</li>
            <li><b>Clarity:</b> “Here are the signals I can point to.”</li>
            <li><b>Action:</b> “I can hand a coherent bundle to a professional.”</li>
            <li><b>Safety:</b> no account, runs locally in your browser.</li>
          </ul>
        </aside>
      </section>

      <section id="sandbox" class="sandbox" aria-label="RPO Sandbox">
        <!-- LEFT: INPUT -->
        <div class="card">
          <h2>1. INPUT NARRATIVE</h2>
          <p class="sub">
            Write 5–12 sentences. You may anonymize names and dates.
            <br/>Tip: include at least one time anchor (date/time), one place, and 2–3 concrete actions.
          </p>

          <label for="context">CONTEXT</label>
          <select id="context">
            <option value="work" selected>Workplace</option>
            <option value="platform">Platform / moderation</option>
            <option value="institution">Institution / administration</option>
            <option value="family">Family / custody</option>
            <option value="cyber">Cyber / incident</option>
            <option value="other">Other</option>
          </select>

          <label for="caseTitle">CASE TITLE</label>
          <input id="caseTitle" type="text" placeholder="Example: Incident in Paris office — March 2024" />

          <label for="issuer">ISSUER (WHO FILES THE BUNDLE)</label>
          <input id="issuer" type="text" placeholder="Example: Internal audit team, Company X" />

          <label for="subject">SUBJECT (WHO / WHAT IS CONCERNED)</label>
          <input id="subject" type="text" placeholder="Example: Employee — Sales department" />

          <label for="narrative">NARRATIVE (FREE TEXT)</label>
          <textarea id="narrative" placeholder="Paste 1–3 paragraphs here..."></textarea>

          <div class="btn-row">
            <button class="btn primary" id="analyzeBtn" type="button">ANALYZE &amp; GENERATE DRAFT BUNDLE</button>
            <button class="btn ghost" id="loadExampleBtn" type="button">LOAD EXAMPLE</button>
            <button class="btn ghost" id="resetBtn" type="button">RESET</button>
          </div>

          <div class="fineprint">
            <div class="k">No AI.</div>
            Conservative rules only. Same input → same output. This sandbox does not store your text. Refreshing the page clears everything.
          </div>
        </div>

        <!-- RIGHT: OUTPUTS -->
        <div class="card">
          <h2>2. DRAFT RPO BUNDLE</h2>
          <p class="sub">
            Deterministic extraction: basic anchors, signals, axes, and thresholds.
            The goal is to create a <b>coherent handover</b> (not a judgment).
          </p>

          <div class="metrics-grid" aria-label="Bundle metrics">
            <div class="mini">
              <div class="t">PHRASES</div>
              <div class="v" id="mPhrases">—</div>
            </div>
            <div class="mini">
              <div class="t">SIGNALS</div>
              <div class="v" id="mSignals">—</div>
            </div>
            <div class="mini">
              <div class="t">STRUCTURE SCORE</div>
              <div class="v" id="mCoherence">—</div>
            </div>
            <div class="mini">
              <div class="t">DATES DETECTED</div>
              <div class="v" id="mDates">—</div>
            </div>
            <div class="mini">
              <div class="t">PLACES DETECTED</div>
              <div class="v" id="mPlaces">—</div>
            </div>
            <div class="mini">
              <div class="t">TIMELINE CONFIDENCE</div>
              <div class="v" id="mChrono">—</div>
            </div>
          </div>

          <div class="hashbox">
            <div class="t">PUBLIC_HASH (SHA256)</div>
            <div class="hash" id="publicHash">—</div>
          </div>

          <div class="section-title">CANONICAL MAP (SIGNALS → AXES → THRESHOLDS)</div>
          <p class="sub" style="margin-top:8px">
            Draft table — conservative and approximate. It is meant to be readable and actionable.
          </p>

          <table aria-label="Canonical map table">
            <thead>
              <tr>
                <th style="width:34%">AXIS</th>
                <th style="width:26%">LEVEL</th>
                <th>WHY (SIGNALS)</th>
              </tr>
            </thead>
            <tbody id="axisTable">
              <tr>
                <td>Isolation / confinement</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
              <tr>
                <td>Threats / coercion</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
              <tr>
                <td>Control of communications</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
              <tr>
                <td>Economic / resource control</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
              <tr>
                <td>Harassment / humiliation</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
              <tr>
                <td>Privacy / surveillance</td>
                <td><span class="pill ok">None</span></td>
                <td>—</td>
              </tr>
            </tbody>
          </table>

          <div class="section-title" style="margin-top:14px">HIGHLIGHTED SENSITIVE PASSAGES</div>
          <div class="highlights" id="highlights">
            <p class="sub">Passages are highlighted when they contain strong markers (threats, confinement, surveillance, economic pressure...).</p>
            <div class="hl-item">— Nothing yet. Click “Analyze”.</div>
          </div>

          <div class="section-title" style="margin-top:14px">RPO.JSON (DRAFT)</div>
          <div class="json-head">
            <div class="sub" style="margin:0">
              Copy or download the deterministic draft JSON. (No signing here — format illustration.)
            </div>
            <div class="json-actions">
              <button class="btn ghost" id="copyJsonBtn" type="button">COPY JSON</button>
              <button class="btn ghost" id="downloadJsonBtn" type="button">DOWNLOAD RPO.JSON</button>
            </div>
          </div>
          <pre class="code" id="jsonOut">{}</pre>
        </div>
      </section>

      <section class="footer-cta" aria-label="Pilot CTA">
        <p>
          Want the full pilot (CNRS × TruthX): <span class="hl">interpretive coherence</span>, structured narrative layers,
          advanced signal fusion, and a human-readable probative report designed for professionals.
        </p>
        <a href="https://www.truthx.co/truthx-pilote-form" target="_blank" rel="noopener noreferrer">REQUEST PILOT ACCESS</a>
      </section>

      <p class="bottom-note">
        This sandbox illustrates a public format. It does not host case data, and it does not decide truth. It reveals structure.
      </p>
    </div>
  </main>

  <script>
    /* =========================================================
       Interstellar field (deterministic-ish visual, non-data)
       ========================================================= */
    (function () {
      const canvas = document.getElementById("bg-field");
      const ctx = canvas.getContext("2d");

      let width = window.innerWidth;
      let height = window.innerHeight;
      let particles = [];
      const COUNT = 220;

      function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        const ratio = window.devicePixelRatio || 1;
        canvas.width = width * ratio;
        canvas.height = height * ratio;
        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
      }

      function createParticle() {
        return {
          x: (Math.random() * 2 - 1),
          y: (Math.random() * 2 - 1),
          z: Math.random() * 0.9 + 0.1,
          speed: Math.random() * 0.004 + 0.0015,
          vertical: Math.random() < 0.25,
          code: Math.random() < 0.18,
          value: Math.random() < 0.5
            ? (0.6 + Math.random() * 0.4).toFixed(2)
            : (10 + Math.floor(Math.random() * 90)) + "%",
        };
      }

      function init() {
        particles = [];
        for (let i = 0; i < COUNT; i++) particles.push(createParticle());
      }

      function project(p) {
        const f = 400;
        const scale = f / (f * p.z);
        return {
          x: p.x * width * 0.5 * scale + width / 2,
          y: p.y * height * 0.5 * scale + height / 2,
          scale
        };
      }

      function update() {
        ctx.clearRect(0, 0, width, height);

        // soft nebula
        const grad = ctx.createRadialGradient(
          width * 0.5, height * 0.2, 0,
          width * 0.5, height * 0.2, width * 0.6
        );
        grad.addColorStop(0, "rgba(241,230,163,0.22)");
        grad.addColorStop(0.4, "rgba(241,230,163,0.04)");
        grad.addColorStop(1, "transparent");
        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, width, height);

        particles.forEach(p => {
          p.z -= p.speed;
          if (p.z < 0.08) {
            Object.assign(p, createParticle());
            p.z = 1;
          }

          const proj = project(p);
          const alpha = Math.min(1, (1.2 - p.z) * 1.1);
          const radius = Math.max(0.8, 3.6 * (1.1 - p.z));

          // vertical “data column”
          if (p.vertical && proj.y < height * 0.9) {
            ctx.strokeStyle = `rgba(241,230,163,${0.14 * alpha})`;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(proj.x, proj.y);
            ctx.lineTo(proj.x, proj.y + 46 * (1.1 - p.z));
            ctx.stroke();

            // small cross marker
            ctx.beginPath();
            ctx.moveTo(proj.x - 4, proj.y + 6);
            ctx.lineTo(proj.x + 4, proj.y + 6);
            ctx.moveTo(proj.x, proj.y + 2);
            ctx.lineTo(proj.x, proj.y + 10);
            ctx.stroke();
          }

          // glowing dot
          const gradDot = ctx.createRadialGradient(proj.x, proj.y, 0, proj.x, proj.y, radius * 3);
          gradDot.addColorStop(0, `rgba(248,238,192,${0.95 * alpha})`);
          gradDot.addColorStop(0.4, `rgba(212,175,55,${0.9 * alpha})`);
          gradDot.addColorStop(1, `rgba(0,0,0,0)`);
          ctx.fillStyle = gradDot;
          ctx.beginPath();
          ctx.arc(proj.x, proj.y, radius * 3, 0, Math.PI * 2);
          ctx.fill();

          ctx.fillStyle = `rgba(248,238,192,${0.8 * alpha})`;
          ctx.beginPath();
          ctx.arc(proj.x, proj.y, radius, 0, Math.PI * 2);
          ctx.fill();

          if (p.code && proj.y > 40 && proj.y < height - 40 && Math.random() < 0.25) {
            ctx.font = `${10 + 6 * (1.1 - p.z)}px "Orbitron", system-ui`;
            ctx.fillStyle = `rgba(241,230,163,${0.78 * alpha})`;
            ctx.fillText(p.value, proj.x + 6, proj.y - 4);
          }
        });

        requestAnimationFrame(update);
      }

      window.addEventListener("resize", resize);
      resize();
      init();
      update();
    })();

    /* =========================================================
       Deterministic sandbox logic (no AI)
       ========================================================= */

    const $ = (id) => document.getElementById(id);

    const EXAMPLE = {
      context: "work",
      caseTitle: "Incident in Paris office — March 2024",
      issuer: "Internal audit team, Company X",
      subject: "Employee — Sales department",
      narrative:
`On 14 March 2024, around 10:30 am, an argument broke out in the Paris office between a line manager and a sales employee.
Several colleagues report that the manager raised his voice, threatened to remove key accounts from the employee, and asked him to leave the open space immediately.
Later that day, around 3 pm, the same manager sent an email copying HR, questioning the employee’s “loyalty” and suggesting he should be excluded from client meetings.
No formal warning or prior evaluation had been communicated before this incident.`
    };

    const AXES = [
      { key:"isolation", label:"Isolation / confinement" },
      { key:"threats", label:"Threats / coercion" },
      { key:"comms", label:"Control of communications" },
      { key:"economic", label:"Economic / resource control" },
      { key:"harassment", label:"Harassment / humiliation" },
      { key:"privacy", label:"Privacy / surveillance" },
    ];

    // Keyword rules (conservative)
    const SIGNAL_RULES = [
      { axis:"threats",    words:["threaten","threatened","coerce","coercion","intimidat","ultimatum","blackmail"] , why:"threat" },
      { axis:"economic",   words:["account","accounts","bonus","salary","pay","budget","expense","resources","remove key"] , why:"account" },
      { axis:"comms",      words:["do not contact","stop talking","forbidden to speak","blocked","muted","silenced","email copying","cc hr","copying hr","no meeting","excluded from meetings"] , why:"comms" },
      { axis:"isolation",  words:["leave the open space","leave immediately","stay inside","confined","isolated","kept apart","no access"] , why:"isolation" },
      { axis:"harassment", words:["humiliate","ridicule","shame","insult","raised his voice","yelled","harassed","bully","hostile"] , why:"humiliation" },
      { axis:"privacy",    words:["surveillance","recorded","tracked","spy","monitor","cctv","camera","screenshots","keylogger"] , why:"surveillance" },
    ];

    const PLACE_HINTS = [
      "paris","london","berlin","madrid","rome","brussels","tokyo","new york",
      "office","workplace","headquarters","hq","meeting room","open space","home","court","police","school"
    ];

    const ACTION_HINTS = [
      "asked","told","sent","emailed","copied","cc","called","removed","blocked","excluded","reported","threatened","demanded"
    ];

    function splitSentences(text){
      // conservative split
      return text
        .replace(/\r/g,"")
        .split(/(?<=[\.\!\?])\s+(?=[A-Z0-9])/)
        .map(s => s.trim())
        .filter(Boolean);
    }

    function detectDates(text){
      const hits = new Set();

      // ISO and common patterns
      const re = [
        /\b\d{4}-\d{2}-\d{2}\b/g,
        /\b\d{1,2}\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec)[a-z]*\s+\d{4}\b/gi,
        /\b(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},\s+\d{4}\b/gi,
        /\b\d{1,2}\/\d{1,2}\/\d{2,4}\b/g,
        /\b\d{1,2}:\d{2}\b/g,
        /\b(am|pm)\b/gi
      ];

      re.forEach(r=>{
        const m = text.match(r);
        if (m) m.forEach(x => hits.add(x.trim()));
      });

      return Array.from(hits).slice(0, 8);
    }

    function detectPlaces(text){
      const t = text.toLowerCase();
      const hits = new Set();
      PLACE_HINTS.forEach(p=>{
        if (t.includes(p)) hits.add(p);
      });
      return Array.from(hits).slice(0, 8);
    }

    function detectSignals(sentences){
      const found = [];
      const lowerSent = sentences.map(s => s.toLowerCase());

      SIGNAL_RULES.forEach(rule=>{
        for (let i=0;i<lowerSent.length;i++){
          const s = lowerSent[i];
          const hit = rule.words.find(w => s.includes(w));
          if (hit){
            found.push({
              axis: rule.axis,
              why: rule.why,
              sentenceIndex: i,
              snippet: sentences[i],
              matched: hit
            });
          }
        }
      });

      // de-duplicate by axis+sentenceIndex
      const uniq = new Map();
      found.forEach(f=>{
        const k = f.axis + "::" + f.sentenceIndex;
        if (!uniq.has(k)) uniq.set(k, f);
      });
      return Array.from(uniq.values());
    }

    function computeScores(sentences, dates, places, signals, text){
      const t = text.toLowerCase();

      // anchors
      const hasDate = dates.length > 0 ? 1 : 0;
      const hasPlace = places.length > 0 ? 1 : 0;

      // action density
      let actions = 0;
      ACTION_HINTS.forEach(a=>{
        if (t.includes(a)) actions++;
      });
      const actionScore = Math.min(1, actions / 4); // conservative

      // sentence count sanity
      const sCount = sentences.length;
      const sScore = sCount >= 3 ? 1 : (sCount === 2 ? 0.7 : 0.4);

      // signal presence
      const sigScore = Math.min(1, signals.length / 4);

      // structure score (NOT truth)
      const raw = (0.22*hasDate + 0.18*hasPlace + 0.22*actionScore + 0.18*sScore + 0.20*sigScore);
      const structure = Math.round(100 * raw);

      // chronology confidence: dates + ordering cues
      const orderingCues = (t.includes("later") || t.includes("then") || t.includes("after") || t.includes("around")) ? 1 : 0;
      const chrono = Math.round(100 * Math.min(1, 0.65*(dates.length ? 1 : 0) + 0.35*orderingCues));

      return { structure, chrono };
    }

    function axisSummary(signals){
      const byAxis = {};
      AXES.forEach(a => byAxis[a.key] = []);
      signals.forEach(s => byAxis[s.axis].push(s));

      const rows = AXES.map(a=>{
        const list = byAxis[a.key];
        if (!list || list.length === 0){
          return { axis:a.label, level:"None", kind:"ok", why:"—" };
        }
        const cues = list.slice(0,2).map(x=>x.why).join(", ");
        return { axis:a.label, level:`Present — ${list.length} cue${list.length>1?"s":""}`, kind:"warn", why:cues || "signal" };
      });
      return rows;
    }

    function highlightText(sent, signals){
      // highlight matched keyword (first occurrence) conservatively
      let s = sent;
      const lower = sent.toLowerCase();
      const sigsHere = signals.filter(x => x.snippet === sent);

      sigsHere.forEach(sig=>{
        const m = sig.matched;
        const idx = lower.indexOf(m);
        if (idx >= 0){
          const before = s.slice(0, idx);
          const mid = s.slice(idx, idx + m.length);
          const after = s.slice(idx + m.length);
          s = before + "<mark>" + mid + "</mark>" + after;
        }
      });
      return s;
    }

    async function sha256Hex(str){
      const enc = new TextEncoder();
      const data = enc.encode(str);
      const hash = await crypto.subtle.digest("SHA-256", data);
      const bytes = Array.from(new Uint8Array(hash));
      return bytes.map(b=>b.toString(16).padStart(2,"0")).join("");
    }

    function safeText(v){
      return (v || "").toString().trim();
    }

    function nowISO(){
      return new Date().toISOString();
    }

    function buildRpoDraft(input, analysis){
      const bundleId = "rpo-" + analysis.public_hash.slice(0, 12);
      return {
        rpo_version: "0.1",
        bundle_id: bundleId,
        created_at: nowISO(),
        issuer: { label: input.issuer || "—" },
        subject: { label: input.subject || "—" },
        case: {
          title: input.caseTitle || "—",
          context: input.context || "other"
        },
        inputs: {
          narrative: input.narrative,
          notes: "Deterministic sandbox extraction. No AI. Not legal advice."
        },
        extraction: {
          phrases: analysis.phrases,
          dates_detected: analysis.dates_detected,
          places_detected: analysis.places_detected,
          signals: analysis.signals.map(s => ({
            axis: s.axis,
            why: s.why,
            sentence_index: s.sentenceIndex
          })),
          canonical_map: analysis.axis_rows
        },
        scores: {
          structure_score: analysis.structure_score,
          chronology_confidence: analysis.chronology_confidence
        },
        integrity: {
          public_hash_sha256: analysis.public_hash,
          statement: "Hash proves integrity, not truth."
        }
      };
    }

    function renderAxisTable(rows){
      const tbody = $("axisTable");
      tbody.innerHTML = "";
      rows.forEach(r=>{
        const tr = document.createElement("tr");

        const tdA = document.createElement("td");
        tdA.textContent = r.axis;

        const tdL = document.createElement("td");
        const pill = document.createElement("span");
        pill.className = "pill " + (r.kind === "warn" ? "warn" : "ok");
        pill.textContent = r.level;
        tdL.appendChild(pill);

        const tdW = document.createElement("td");
        tdW.textContent = r.why;

        tr.appendChild(tdA);
        tr.appendChild(tdL);
        tr.appendChild(tdW);
        tbody.appendChild(tr);
      });
    }

    function renderHighlights(sentences, signals){
      const box = $("highlights");
      const strong = signals
        .slice()
        .sort((a,b)=>a.sentenceIndex - b.sentenceIndex)
        .slice(0, 6);

      if (strong.length === 0){
        box.innerHTML = `
          <p class="sub">Passages are highlighted when they contain strong markers (threats, confinement, surveillance, economic pressure...).</p>
          <div class="hl-item">— No strong markers detected in this input.</div>
        `;
        return;
      }

      const items = strong.map(sig=>{
        const sent = sentences[sig.sentenceIndex] || sig.snippet;
        const html = highlightText(sent, [sig]);
        return `<div class="hl-item">• ${html}</div>`;
      }).join("");

      box.innerHTML = `
        <p class="sub">Passages are highlighted when they contain strong markers (threats, confinement, surveillance, economic pressure...).</p>
        ${items}
      `;
    }

    function setMetrics(m){
      $("mPhrases").textContent = m.phrases;
      $("mSignals").textContent = m.signals_count;
      $("mCoherence").textContent = m.structure_score;
      $("mDates").textContent = m.dates_detected;
      $("mPlaces").textContent = m.places_detected;
      $("mChrono").textContent = m.chronology_confidence;
      $("publicHash").textContent = m.public_hash || "—";
    }

    function downloadJson(filename, obj){
      const blob = new Blob([JSON.stringify(obj, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    function copyToClipboard(text){
      return navigator.clipboard.writeText(text);
    }

    // Buttons
    $("loadExampleBtn").addEventListener("click", ()=>{
      $("context").value = EXAMPLE.context;
      $("caseTitle").value = EXAMPLE.caseTitle;
      $("issuer").value = EXAMPLE.issuer;
      $("subject").value = EXAMPLE.subject;
      $("narrative").value = EXAMPLE.narrative;
      // keep outputs unchanged until analyze
    });

    $("resetBtn").addEventListener("click", ()=>{
      $("context").value = "work";
      $("caseTitle").value = "";
      $("issuer").value = "";
      $("subject").value = "";
      $("narrative").value = "";

      setMetrics({
        phrases:"—",
        signals_count:"—",
        structure_score:"—",
        dates_detected:"—",
        places_detected:"—",
        chronology_confidence:"—",
        public_hash:"—"
      });

      renderAxisTable(axisSummary([]));
      $("jsonOut").textContent = "{}";
      $("highlights").innerHTML = `
        <p class="sub">Passages are highlighted when they contain strong markers (threats, confinement, surveillance, economic pressure...).</p>
        <div class="hl-item">— Nothing yet. Click “Analyze”.</div>
      `;
      window.__LAST_DRAFT__ = null;
    });

    $("analyzeBtn").addEventListener("click", async ()=>{
      const input = {
        context: safeText($("context").value),
        caseTitle: safeText($("caseTitle").value),
        issuer: safeText($("issuer").value),
        subject: safeText($("subject").value),
        narrative: safeText($("narrative").value)
      };

      if (!input.narrative || input.narrative.length < 20){
        alert("Please paste a short narrative first (at least a few sentences).");
        return;
      }

      const sentences = splitSentences(input.narrative);
      const dates = detectDates(input.narrative);
      const places = detectPlaces(input.narrative);
      const signals = detectSignals(sentences);

      const scores = computeScores(sentences, dates, places, signals, input.narrative);

      // Stable payload for hashing (same input -> same hash)
      const hashPayload = JSON.stringify({
        v:"0.1",
        context: input.context,
        caseTitle: input.caseTitle,
        issuer: input.issuer,
        subject: input.subject,
        narrative: input.narrative,
        signals: signals.map(s=>({axis:s.axis, why:s.why, i:s.sentenceIndex})).sort((a,b)=> (a.axis+b.why+a.i).localeCompare(b.axis+b.why+b.i)),
        dates: dates.sort(),
        places: places.sort(),
        scores
      });

      const public_hash = await sha256Hex(hashPayload);

      const axis_rows = axisSummary(signals);

      const analysis = {
        phrases: sentences.length,
        signals_count: signals.length,
        dates_detected: dates.length,
        places_detected: places.length,
        structure_score: scores.structure,
        chronology_confidence: scores.chrono,
        public_hash,
        signals,
        axis_rows
      };

      setMetrics(analysis);
      renderAxisTable(axis_rows);
      renderHighlights(sentences, signals);

      const draft = buildRpoDraft(input, analysis);
      $("jsonOut").textContent = JSON.stringify(draft, null, 2);
      window.__LAST_DRAFT__ = draft;
    });

    $("copyJsonBtn").addEventListener("click", async ()=>{
      const text = $("jsonOut").textContent || "{}";
      try{
        await copyToClipboard(text);
        alert("JSON copied to clipboard.");
      }catch(e){
        alert("Clipboard blocked by browser. Select and copy manually.");
      }
    });

    $("downloadJsonBtn").addEventListener("click", ()=>{
      const draft = window.__LAST_DRAFT__;
      if (!draft){
        alert("Nothing to download yet. Click Analyze first.");
        return;
      }
      downloadJson("rpo.json", draft);
    });
  </script>
</body>
</html>



