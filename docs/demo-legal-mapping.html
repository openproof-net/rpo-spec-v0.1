<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OpenProof — Legal Mapping Layer Demo | From narrative patterns to legal domains</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- SEO -->
  <meta name="description"
        content="Legal Mapping Layer demo: from narrative patterns to potential legal domains. Non-normative, jurisdiction-agnostic, and compatible with the RPO (Rapport Probatoire Ouvert) standard." />
  <meta name="author" content="Gersende Ryard de Parcey" />
  <link rel="canonical" href="https://rpo.openproof.net/demo-legal-mapping.html" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="OpenProof — Legal Mapping Layer Demo" />
  <meta property="og:description"
        content="From psycho-forensic patterns to potential legal domains: an orientation layer on top of the RPO standard. Non-binding and jurisdiction-agnostic." />
  <meta property="og:url" content="https://rpo.openproof.net/demo-legal-mapping.html" />
  <meta property="og:image"
        content="https://uploads.strikinglycdn.com/files/5b108f2f-0feb-4789-a4dd-d1d21cd5eec6/Capture%20d%E2%80%99e%CC%81cran%202025-11-01%20a%CC%80%2016.30.35.png" />

  <!-- Favicon OpenProof -->
  <link
    rel="icon"
    type="image/png"
    href="https://uploads.strikinglycdn.com/files/5b108f2f-0feb-4789-a4dd-d1d21cd5eec6/Capture%20d%E2%80%99e%CC%81cran%202025-11-01%20a%CC%80%2016.30.35.png"
  />

  <!-- Minimal dark/ivory/gold theme -->
  <style>
    :root {
      --bg: #04040e;
      --bg-elevated: #0b0f14;
      --panel: #f7f3e8;
      --panel-soft: #fbf8f1;
      --text-main: #f5f5f7;
      --text-muted: #b2b7c5;
      --ink: #7a6432;
      --gold: #d4af37;
      --gold-soft: #f1e6a3;
      --border-soft: rgba(241, 230, 163, 0.2);
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.45);
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, system-ui, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111625 0, var(--bg) 45%);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
    }

    a {
      color: var(--gold-soft);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    /* Nav */
    .nav {
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(16px);
      background: linear-gradient(
        90deg,
        rgba(4, 4, 14, 0.96),
        rgba(4, 4, 14, 0.92)
      );
      border-bottom: 1px solid var(--border-soft);
    }

    .nav-inner {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0.65rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .nav-left {
      display: flex;
      align-items: center;
    }

    .nav-logo-link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: var(--text-main);
    }

    .nav-logo {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #f3e8b2, #b88c2a);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.4),
        0 10px 25px rgba(0, 0, 0, 0.6);
    }

    .nav-logo img {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      display: block;
    }

    .nav-title {
      font-size: 0.95rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--gold-soft);
    }

    .nav-subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 1.1rem;
      font-size: 0.9rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .nav-link {
      color: var(--text-muted);
      text-decoration: none;
      white-space: nowrap;
    }

    .nav-link:hover {
      color: var(--gold-soft);
    }

    .nav-link.active {
      color: var(--gold-soft);
      font-weight: 600;
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 0.4rem 0.95rem;
      border: 1px solid var(--border-soft);
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      text-decoration: none;
      color: var(--gold-soft);
      background: rgba(10, 14, 24, 0.9);
      white-space: nowrap;
    }

    .btn-ghost span {
      font-size: 0.9rem;
    }

    .btn-ghost:hover {
      border-color: var(--gold-soft);
      text-decoration: none;
      background: rgba(13, 18, 30, 0.95);
    }

    @media (max-width: 820px) {
      .nav-inner {
        flex-direction: column;
        align-items: flex-start;
      }
      .nav-links {
        width: 100%;
        justify-content: flex-start;
        row-gap: 0.35rem;
      }
    }

    /* Hero */
    .hero {
      padding: 3.1rem 1.5rem 2.3rem;
    }

    .hero-inner {
      max-width: 1120px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.8fr);
      gap: 2.1rem;
      align-items: center;
    }

    @media (max-width: 900px) {
      .hero-inner {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hero-kicker {
      font-size: 0.8rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--gold-soft);
      margin-bottom: 0.75rem;
    }

    .hero-title {
      font-size: clamp(2rem, 2.8vw, 2.5rem);
      line-height: 1.2;
      margin: 0 0 0.75rem;
    }

    .hero-title span {
      color: var(--gold-soft);
    }

    .hero-subtitle {
      font-size: 0.97rem;
      color: var(--text-muted);
      max-width: 32rem;
      margin-bottom: 1.25rem;
    }

    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.45rem;
      margin-bottom: 1.1rem;
    }

    .badge {
      font-size: 0.78rem;
      padding: 0.18rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(241, 230, 163, 0.3);
      color: var(--gold-soft);
      background: rgba(11, 15, 20, 0.9);
    }

    .hero-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
      max-width: 34rem;
    }

    .hero-meta strong {
      color: var(--gold-soft);
      font-weight: 500;
    }

    .hero-card {
      max-width: 440px;
      margin-left: auto;
      background: radial-gradient(circle at top left, #1b2236, #050711);
      border-radius: var(--radius-lg);
      padding: 1.4rem 1.6rem 1.5rem;
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-soft);
    }

    @media (max-width: 900px) {
      .hero-card {
        margin: 1.4rem 0 0;
        max-width: 100%;
      }
    }

    .hero-card-title {
      font-size: 0.88rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--gold-soft);
      margin: 0 0 0.4rem;
    }

    .hero-card-subtitle {
      font-size: 0.85rem;
      color: var(--text-main);
      margin-bottom: 0.6rem;
    }

    .hero-card-list {
      list-style: none;
      padding-left: 0;
      margin: 0 0 0.65rem;
      font-size: 0.82rem;
      color: var(--text-main);
    }

    .hero-card-list li {
      display: flex;
      gap: 0.4rem;
      align-items: flex-start;
    }

    .hero-card-list li + li {
      margin-top: 0.3rem;
    }

    .hero-card-bullet {
      font-size: 0.9rem;
      line-height: 1.2;
      color: var(--gold-soft);
    }

    .hero-card-note {
      font-size: 0.76rem;
      color: var(--text-muted);
      line-height: 1.5;
      margin-top: 0.4rem;
    }

    /* Main layout */
    .main {
      padding: 0 1.5rem 3.4rem;
    }

    .section-title {
      max-width: 1120px;
      margin: 0 auto 0.8rem;
      padding: 0 0.1rem;
      font-size: 0.83rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
    }

    .grid {
      max-width: 1120px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1.7fr);
      gap: 1.9rem;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: linear-gradient(145deg, var(--panel), var(--panel-soft));
      border-radius: var(--radius-lg);
      padding: 1.5rem 1.6rem 1.6rem;
      box-shadow: var(--shadow-soft);
      color: var(--ink);
      border-top: 3px solid var(--gold);
    }

    .panel h2 {
      margin-top: 0;
      font-size: 1.02rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #5c4721;
      margin-bottom: 0.7rem;
    }

    .panel p {
      font-size: 0.88rem;
      line-height: 1.5;
      margin-top: 0;
    }

    .panel-intro {
      max-width: 1120px;
      margin: 0 auto 1.7rem;
      display: grid;
      grid-template-columns: minmax(0, 1.8fr) minmax(0, 1.2fr);
      gap: 1.4rem;
    }

    @media (max-width: 900px) {
      .panel-intro {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel-soft {
      background: radial-gradient(circle at top left, #1b2236, #050711);
      border-radius: var(--radius-lg);
      padding: 1.3rem 1.4rem;
      border: 1px solid var(--border-soft);
      color: var(--text-main);
      box-shadow: var(--shadow-soft);
      font-size: 0.88rem;
    }

    .panel-soft h3 {
      margin: 0 0 0.6rem;
      font-size: 0.9rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--gold-soft);
    }

    .panel-soft p {
      margin: 0 0 0.4rem;
      font-size: 0.84rem;
      color: var(--text-muted);
    }

    .panel-soft ul {
      margin: 0.35rem 0 0;
      padding-left: 1.1rem;
      font-size: 0.84rem;
    }

    .panel-soft li + li {
      margin-top: 0.15rem;
    }

    /* Form */
    .form-group {
      margin-bottom: 0.8rem;
    }

    .form-label {
      display: block;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 0.25rem;
      color: #5c4721;
    }

    .textarea {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(122, 100, 50, 0.25);
      padding: 0.55rem 0.65rem;
      font-size: 0.9rem;
      font-family: inherit;
      color: #3a2c12;
      background: #fdfbf7;
      outline: none;
      min-height: 170px;
      resize: vertical;
    }

    .textarea:focus {
      border-color: var(--gold);
      box-shadow: 0 0 0 1px rgba(212,175,55,0.35);
    }

    .helper {
      font-size: 0.76rem;
      color: #7a6432;
      margin-top: 0.1rem;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.55rem;
      margin-top: 0.9rem;
    }

    .btn-primary {
      border-radius: 999px;
      padding: 0.4rem 1.05rem;
      border: none;
      font-size: 0.88rem;
      font-weight: 500;
      cursor: pointer;
      background: linear-gradient(135deg, #d4af37, #f1e6a3);
      color: #2a210e;
      box-shadow: 0 12px 26px rgba(0,0,0,0.25);
      white-space: nowrap;
    }

    .btn-primary:hover {
      filter: brightness(1.03);
    }

    .btn-secondary {
      border-radius: 999px;
      padding: 0.38rem 0.95rem;
      border: 1px solid rgba(122, 100, 50, 0.4);
      font-size: 0.82rem;
      cursor: pointer;
      background: transparent;
      color: #5c4721;
      white-space: nowrap;
    }

    .btn-secondary:hover {
      background: rgba(212,175,55,0.08);
    }

    .disclaimer {
      margin-top: 0.75rem;
      font-size: 0.76rem;
      color: #7a6432;
      border-radius: 10px;
      border: 1px dashed rgba(122,100,50,0.45);
      padding: 0.5rem 0.6rem;
      background: rgba(253,251,247,0.8);
    }

    /* Mapping results */
    .result-header {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      justify-content: space-between;
      gap: 0.4rem;
      margin-bottom: 0.6rem;
    }

    .result-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #5c4721;
    }

    .result-metrics {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      font-size: 0.75rem;
    }

    .pill {
      padding: 0.18rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(122,100,50,0.4);
      background: rgba(255,255,255,0.7);
      color: #3a2c12;
      white-space: nowrap;
    }

    .mapping-table-wrapper {
      border-radius: 12px;
      border: 1px solid rgba(212,175,55,0.4);
      background: rgba(255,255,255,0.9);
      padding: 0.6rem 0.65rem 0.65rem;
      font-size: 0.8rem;
      overflow-x: auto;
    }

    table.mapping-table {
      width: 100%;
      border-collapse: collapse;
      min-width: 480px;
    }

    table.mapping-table th,
    table.mapping-table td {
      padding: 0.35rem 0.4rem;
      text-align: left;
      vertical-align: top;
    }

    table.mapping-table th {
      font-size: 0.76rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #8a6c33;
      border-bottom: 1px solid rgba(122,100,50,0.35);
      white-space: nowrap;
    }

    table.mapping-table td {
      border-bottom: 1px solid rgba(122,100,50,0.12);
      color: #3a2c12;
    }

    table.mapping-table tr:last-child td {
      border-bottom: none;
    }

    .badge-strength {
      display: inline-flex;
      align-items: center;
      padding: 0.12rem 0.5rem;
      border-radius: 999px;
      font-size: 0.72rem;
      font-weight: 500;
      border: 1px solid rgba(122,100,50,0.5);
      background: #fdf7e7;
    }

    .badge-strength.strong {
      border-color: #b86a2a;
      background: #fbe7cf;
    }

    .badge-strength.present {
      border-color: rgba(122,100,50,0.6);
      background: #fbf3dd;
    }

    .badge-strength.none {
      border-color: rgba(122,100,50,0.25);
      background: #faf7ef;
      color: #7c6a43;
    }

    .mapping-note {
      font-size: 0.76rem;
      color: #7a6432;
      margin-top: 0.5rem;
    }

    .mapping-note strong {
      font-weight: 600;
    }

    .legal-cta-panel {
      max-width: 1120px;
      margin: 2.2rem auto 0;
      padding: 1.2rem 1.4rem;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(212,175,55,0.4);
      background: radial-gradient(circle at top left, #1b2236, #050711);
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 0.7rem;
      font-size: 0.88rem;
      color: var(--text-main);
    }

    .legal-cta-panel strong {
      color: var(--gold-soft);
    }

    .cta-btn {
      border-radius: 999px;
      padding: 0.45rem 1.2rem;
      border: none;
      font-size: 0.86rem;
      font-weight: 500;
      background: linear-gradient(135deg, #d4af37, #f1e6a3);
      color: #2a210e;
      text-decoration: none;
      box-shadow: 0 12px 26px rgba(0,0,0,0.25);
      white-space: nowrap;
    }

    .cta-btn:hover {
      filter: brightness(1.03);
      text-decoration: none;
    }

    /* Footer */
    .footer {
      border-top: 1px solid var(--border-soft);
      background: radial-gradient(circle at top, #101525, #020308);
      padding: 1.6rem 1.5rem 2.1rem;
      color: var(--text-muted);
      font-size: 0.82rem;
    }

    .footer-inner {
      max-width: 1120px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 0.8rem;
    }

    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.9rem;
      align-items: center;
    }

    .footer-links a {
      color: var(--text-muted);
      text-decoration: none;
    }

    .footer-links a:hover {
      color: var(--gold-soft);
      text-decoration: underline;
    }

    .footer-title {
      font-weight: 500;
      margin-bottom: 0.15rem;
    }

    .footer-text span {
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <header class="nav">
    <div class="nav-inner">
      <div class="nav-left">
        <a href="index.html" class="nav-logo-link">
          <div class="nav-logo">
            <img
              src="https://uploads.strikinglycdn.com/files/5b108f2f-0feb-4789-a4dd-d1d21cd5eec6/Capture%20d%E2%80%99e%CC%81cran%202025-11-01%20a%CC%80%2016.30.35.png"
              alt="OpenProof emblem"
            />
          </div>
          <div>
            <div class="nav-title">OpenProof — RPO v0.1</div>
            <div class="nav-subtitle">Signed JSON • Human-readable PDF • Public hash</div>
          </div>
        </a>
      </div>

      <div class="nav-links">
        <a href="overview.html" class="nav-link">Overview</a>
        <a href="index.html" class="nav-link">Specification</a>
        <a href="examples.html" class="nav-link">Examples</a>
        <a href="tests.html" class="nav-link">Tests</a>
        <a href="playground.html" class="nav-link">Playground</a>
        <a href="demo-psycho.html" class="nav-link">Psycho demo</a>
        <a href="demo-legal.html" class="nav-link">Legal demo</a>
        <a href="demo-legal-mapping.html" class="nav-link active">Legal mapping</a>
        <a
          class="btn-ghost"
          href="https://github.com/openproof-net/rpo-spec-v0.1"
          target="_blank"
          rel="noopener noreferrer"
        >
          <span>View on GitHub</span>
        </a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-inner">
      <div>
        <div class="hero-kicker">Legal Mapping Layer • Orientation only</div>
        <h1 class="hero-title">
          From narrative <span>patterns</span> to potential legal domains
        </h1>
        <p class="hero-subtitle">
          This demo shows how a structured narrative analysis can be projected onto
          <strong>legal domains</strong> (liberty, coercion, economic pressure, privacy)
          without turning into automated legal qualification.
        </p>
        <div class="hero-badges">
          <div class="badge">Orientation only</div>
          <div class="badge">Jurisdiction-agnostic</div>
          <div class="badge">Non-normative</div>
        </div>
        <div class="hero-meta">
          This layer sits <strong>on top of the psycho-forensic demo</strong>. It does not decide
          “what the law says” — it suggests <strong>where a jurist could look</strong>, based on
          structural patterns already detected in the narrative.
        </div>
      </div>

      <aside class="hero-card">
        <div class="hero-card-title">What this page illustrates</div>
        <div class="hero-card-subtitle">
          A simple, transparent version of a “legal orientation” layer:
        </div>
        <ul class="hero-card-list">
          <li>
            <span class="hero-card-bullet">•</span>
            <span>It takes a short narrative and reads it through <strong>6 legal domains</strong>.</span>
          </li>
          <li>
            <span class="hero-card-bullet">•</span>
            <span>For each domain, it counts <strong>cues</strong> (signals) and rates them as
              “Present” or “Strong”.</span>
          </li>
          <li>
            <span class="hero-card-bullet">•</span>
            <span>It remains <strong>jurisdiction-agnostic</strong>: no articles, no automatic offences.</span>
          </li>
        </ul>
        <p class="hero-card-note">
          Think of this as a <strong>legal compass</strong>: it does not replace legal reasoning.
          It tells you which directions might deserve attention if the case is escalated.
        </p>
      </aside>
    </div>
  </section>

  <!-- MAIN -->
  <main class="main">
    <!-- INTRO PANELS -->
    <div class="section-title">How this layer fits the RPO stack</div>
    <div class="panel-intro">
      <section class="panel">
        <h2>1. A bridge between structure and law</h2>
        <p>
          The Legal Mapping Layer comes <strong>after</strong> the psycho-forensic reading.
          It assumes that a narrative already shows patterns of control, pressure or abuse,
          and it projects these patterns onto <strong>legal domains</strong>:
          restriction of liberty, threats, economic pressure, harassment, control of communication,
          privacy and surveillance.
        </p>
        <p>
          The goal is not to qualify an offence. The goal is to show how a structured narrative
          could inform <strong>legal orientation</strong> and help professionals decide
          <em>where</em> to look, not <em>what</em> to conclude.
        </p>
      </section>

      <aside class="panel-soft">
        <h3>Three layers, three roles</h3>
        <p>This demo series separates three complementary layers:</p>
        <ul>
          <li><strong>RPO standard:</strong> how a story becomes a proof-ready bundle.</li>
          <li><strong>Psycho-forensic overlay:</strong> how control and coercion patterns emerge.</li>
          <li><strong>Legal mapping layer:</strong> how these patterns may touch legal domains.</li>
        </ul>
        <p>
          This page focuses on the third layer only. It stays
          <strong>non-binding, jurisdiction-agnostic</strong> and compatible with the RPO v0.1 schema.
        </p>
      </aside>
    </div>

    <!-- INTERACTIVE GRID -->
    <div class="section-title">Try the legal mapping demo</div>
    <div class="grid">
      <!-- INPUT PANEL -->
      <section class="panel">
        <h2>2. Load or write a narrative</h2>
        <p>
          Start from a <strong>short narrative</strong> (5–10 sentences). You can anonymise names,
          places and dates. The point is to test how a story with control or pressure signals
          can be mapped to legal domains without turning into automated legal advice.
        </p>

        <div class="form-group">
          <label class="form-label" for="narrative-input">Narrative (free text)</label>
          <textarea
            id="narrative-input"
            class="textarea"
            placeholder="Describe the situation in your own words. What happens, how often, who controls what, which threats or pressures are mentioned?"
          ></textarea>
          <div class="helper">
            Tip: include at least one concrete constraint (freedom, money, communication, threats) so that the mapping has something to work with.
          </div>
        </div>

        <div class="btn-row">
          <button class="btn-primary" id="btn-analyse">Analyse and map legal domains</button>
          <button class="btn-secondary" id="btn-example" type="button">Load example narrative</button>
          <button class="btn-secondary" id="btn-reset" type="button">Reset</button>
        </div>

        <div class="disclaimer">
          <strong>Disclaimer.</strong> This demo is for illustration only. It does not provide legal advice,
          does not qualify any offence and is not a decision system. Only a qualified professional can
          assess the legal implications of a real case.
        </div>
      </section>

      <!-- OUTPUT PANEL -->
      <section class="panel">
        <h2>3. Legal orientation (non-binding)</h2>
        <div class="result-header">
          <div class="result-title">
            Mapping result for this narrative
          </div>
          <div class="result-metrics" id="result-metrics" style="display:none">
            <div class="pill" id="pill-domains">Domains detected: 0</div>
            <div class="pill" id="pill-max-strength">Max strength: –</div>
            <div class="pill" id="pill-cues">Total cues: 0</div>
          </div>
        </div>

        <div class="mapping-table-wrapper" id="mapping-wrapper" style="display:none">
          <table class="mapping-table" aria-label="Legal mapping table">
            <thead>
              <tr>
                <th>Legal domain</th>
                <th>Strength</th>
                <th>What the cues suggest</th>
              </tr>
            </thead>
            <tbody id="mapping-body">
              <!-- Filled by JS -->
            </tbody>
          </table>
        </div>

        <p class="mapping-note" id="mapping-note" style="display:none">
          This table is a <strong>jurisdiction-agnostic</strong> orientation. It highlights domains where
          the narrative structure seems most engaged (for example, liberty, coercion, economic pressure).
          It is meant to support, not replace, human legal reasoning.
        </p>
      </section>
    </div>

    <!-- CTA PANEL -->
    <section class="legal-cta-panel">
      <div>
        <strong>This demo shows an open, rule-based mapping layer.</strong><br />
        In the CNRS × TruthX research pilot, this layer will be combined with advanced
        psycho-forensic models and jurisdiction-specific analysis, under strict ethical
        and scientific supervision.
      </div>
      <a
        class="cta-btn"
        href="https://www.truthx.co/truthx-pilote-form"
        target="_blank"
        rel="noopener noreferrer"
      >
        Apply to the CNRS × TruthX pilot
      </a>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-inner">
      <div class="footer-left">
        <div class="footer-title">OpenProof — RPO Specification v0.1</div>
        <div class="footer-text">
          © 2026 OpenProof Consortium. Research collaboration: CNRS – GREYC – Université de Caen Normandie.
          Concept & narrative architecture: <span>Gersende Ryard de Parcey (TruthX)</span>.
        </div>
      </div>
      <div class="footer-right footer-links">
        <a href="https://www.openproof.net" target="_blank" rel="noopener noreferrer">Technical site</a>
        <span>•</span>
        <a href="https://www.truthx-openproof.org" target="_blank" rel="noopener noreferrer">Governance</a>
        <span>•</span>
        <a href="mailto:openproof@truthx.co">Contact</a>
      </div>
    </div>
  </footer>

  <!-- SIMPLE JS ENGINE -->
  <script>
    const inputEl = document.getElementById("narrative-input");
    const btnAnalyse = document.getElementById("btn-analyse");
    const btnExample = document.getElementById("btn-example");
    const btnReset = document.getElementById("btn-reset");

    const mappingWrapper = document.getElementById("mapping-wrapper");
    const mappingBody = document.getElementById("mapping-body");
    const mappingNote = document.getElementById("mapping-note");

    const metricsEl = document.getElementById("result-metrics");
    const pillDomains = document.getElementById("pill-domains");
    const pillMaxStrength = document.getElementById("pill-max-strength");
    const pillCues = document.getElementById("pill-cues");

    const exampleNarrative = `
Last year, after I moved in with my partner, he started to control more and more aspects of my daily life.
He keeps the car keys and tells me I do not need to go anywhere without him.
When I try to visit my sister, he says that if I leave, he might "make sure the rent is not paid on time".
He constantly checks my phone, asks for screenshots of my messages and insists that I block several contacts,
including my family, saying it is for my own good.
I do not have direct access to our bank account anymore, he gives me cash and asks for receipts for every small expense.
When I disagree or say that this feels unfair, he calls me ungrateful, threatens to "tell everyone I am unstable" and says no one will believe me if I speak.
`.trim();

    const legalDomains = [
      {
        id: "liberty",
        label: "Restriction of liberty / movement",
        description: "Control over freedom of movement, confinement, constraint on where the person can go.",
        keywords: ["go anywhere", "leave", "locked", "car keys", "cannot go", "not allowed to go", "stay home", "move out"]
      },
      {
        id: "coercion",
        label: "Threats and coercion",
        description: "Explicit or implicit threats, conditions, or pressure linked to harm or sanctions.",
        keywords: ["threat", "threaten", "or else", "sanction", "punish", "if you leave", "make sure", "no one will believe", "unstable"]
      },
      {
        id: "economic",
        label: "Economic and resource control",
        description: "Control of money, bank access, basic needs or resources.",
        keywords: ["bank account", "cash", "money", "rent", "pay", "salary", "finance", "gives me", "receipts"]
      },
      {
        id: "communications",
        label: "Control of communications",
        description: "Monitoring or blocking of calls, messages, online accounts or social links.",
        keywords: ["phone", "messages", "screenshots", "block", "contacts", "social media", "no one needs to hear", "checking", "reads my"]
      },
      {
        id: "harassment",
        label: "Harassment and psychological pressure",
        description: "Insults, repeated denigration, gaslighting, humiliation, or degrading remarks.",
        keywords: ["ungrateful", "unstable", "no one will believe", "crazy", "overreacting", "insult", "humiliate", "worthless"]
      },
      {
        id: "privacy",
        label: "Privacy and surveillance",
        description: "Intrusion into private life, tracking, surveillance tools, or constant monitoring.",
        keywords: ["checks my phone", "tracking", "location", "follow", "monitor", "spy", "cameras", "watching", "surveillance"]
      }
    ];

    function countCues(text, keywords) {
      const lowered = text.toLowerCase();
      let count = 0;
      for (const kw of keywords) {
        const pattern = kw.toLowerCase();
        if (lowered.includes(pattern)) {
          count += 1;
        }
      }
      return count;
    }

    function classifyStrength(cues) {
      if (cues >= 3) return "strong";
      if (cues >= 1) return "present";
      return "none";
    }

    function strengthLabel(strength, cues) {
      if (strength === "strong") return `Strong — ${cues} cues`;
      if (strength === "present") return `Present — ${cues} cue${cues > 1 ? "s" : ""}`;
      return "Not detected";
    }

    function analyseNarrative() {
      const text = (inputEl.value || "").trim();
      if (!text) {
        alert("Please paste or write a narrative before running the mapping.");
        return;
      }

      const rows = [];
      let detectedDomains = 0;
      let totalCues = 0;
      let maxStrengthRank = 0;
      const strengthOrder = { none: 0, present: 1, strong: 2 };

      for (const domain of legalDomains) {
        const cues = countCues(text, domain.keywords);
        const strength = classifyStrength(cues);
        const label = strengthLabel(strength, cues);

        if (strength !== "none") {
          detectedDomains += 1;
          totalCues += cues;
          if (strengthOrder[strength] > maxStrengthRank) {
            maxStrengthRank = strengthOrder[strength];
          }
        }

        let explanation;
        if (strength === "none") {
          explanation = "No clear cue detected for this domain in the current narrative.";
        } else if (strength === "present") {
          explanation = "Some elements in the narrative touch this domain and could justify closer legal attention.";
        } else {
          explanation = "Multiple cues converge on this domain, suggesting that it may be central in any legal assessment.";
        }

        rows.push({
          id: domain.id,
          label: domain.label,
          strength,
          labelStrength: label,
          explanation
        });
      }

      // Render table
      mappingBody.innerHTML = "";
      rows.forEach(row => {
        const tr = document.createElement("tr");

        const tdDomain = document.createElement("td");
        tdDomain.textContent = row.label;
        tr.appendChild(tdDomain);

        const tdStrength = document.createElement("td");
        const badge = document.createElement("span");
        badge.className = "badge-strength " + row.strength;
        badge.textContent = row.labelStrength;
        tdStrength.appendChild(badge);
        tr.appendChild(tdStrength);

        const tdExplanation = document.createElement("td");
        tdExplanation.textContent = row.explanation;
        tr.appendChild(tdExplanation);

        mappingBody.appendChild(tr);
      });

      // Metrics
      let maxStrengthLabel = "None";
      if (maxStrengthRank === 1) maxStrengthLabel = "Present";
      if (maxStrengthRank === 2) maxStrengthLabel = "Strong";

      pillDomains.textContent = `Domains detected: ${detectedDomains}`;
      pillMaxStrength.textContent = `Max strength: ${maxStrengthLabel}`;
      pillCues.textContent = `Total cues: ${totalCues}`;

      metricsEl.style.display = "flex";
      mappingWrapper.style.display = "block";
      mappingNote.style.display = "block";
    }

    btnAnalyse.addEventListener("click", (event) => {
      event.preventDefault();
      analyseNarrative();
    });

    btnExample.addEventListener("click", (event) => {
      event.preventDefault();
      inputEl.value = exampleNarrative;
      analyseNarrative();
    });

    btnReset.addEventListener("click", (event) => {
      event.preventDefault();
      inputEl.value = "";
      mappingBody.innerHTML = "";
      mappingWrapper.style.display = "none";
      mappingNote.style.display = "none";
      metricsEl.style.display = "none";
    });
  </script>
</body>
</html>
